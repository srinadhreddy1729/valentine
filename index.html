<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Valentine ¬∑ escape ¬∑ fully responsive</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      min-height: 100vh;
      background: radial-gradient(circle at 40% 30%, #ffd9e6, #ffadc6);
      font-family: 'Quicksand', sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 12px;
      overflow-x: hidden;
    }

    /* floating symbols ‚Äì responsive size via vw */
    .fall {
      position: absolute;
      top: -60px;
      animation: fall linear forwards;
      pointer-events: none;
      z-index: 1;
      user-select: none;
      font-size: clamp(18px, 6vw, 44px); /* dynamic floating size */
    }

    @keyframes fall {
      to {
        transform: translateY(110vh) rotate(360deg);
        opacity: 0;
      }
    }

    /* main card ‚Äì fully fluid */
    .valentine-card {
      width: min(720px, 98%);
      background: rgba(255, 245, 250, 0.85);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border-radius: max(40px, min(8vw, 70px));
      box-shadow: 0 20px 40px rgba(200, 100, 140, 0.4);
      padding: clamp(1.8rem, 6vw, 4rem) clamp(1rem, 4vw, 2.5rem);
      text-align: center;
      position: relative;
      z-index: 10;
      transition: all 0.2s;
    }

    /* headings fluid */
    h1 {
      font-size: clamp(1.5rem, 7vw, 2.8rem);
      color: #93264b;
      margin-bottom: clamp(1.2rem, 4vh, 2.5rem);
      line-height: 1.3;
      word-break: break-word;
    }

    /* button container ‚Äì height adapts */
    .button-swarm {
      position: relative;
      height: clamp(90px, 20vw, 140px);
      width: 100%;
      margin: 0 auto;
    }

    /* base button style ‚Äì fully responsive */
    .btn {
      position: absolute;
      border: none;
      padding: clamp(10px, 2.5vw, 18px) clamp(20px, 5vw, 50px);
      border-radius: 80px;
      font-size: clamp(1rem, 4vw, 1.8rem);
      font-weight: 700;
      cursor: pointer;
      border: 2px solid white;
      white-space: nowrap;
      box-shadow: 0 8px 14px rgba(150, 40, 70, 0.2);
      transition: transform 0.15s, left 0.1s linear, top 0.1s linear;
    }

    /* YES buttons */
    #yesBtn, #yesBtn2 {
      right: max(10px, min(4vw, 25px));
      top: 50%;
      transform: translateY(-50%);
      background: linear-gradient(145deg, #ff4d6d, #e63256);
      color: white;
      z-index: 5;
    }

    #yesBtn:hover, #yesBtn2:hover {
      transform: translateY(-50%) scale(1.05);
    }

    /* NO buttons ‚Äì fleeing */
    #noBtn, #noBtn2 {
      left: max(10px, min(4vw, 25px));
      top: 50%;
      transform: translateY(-50%);
      background: #ffb7c5;
      color: #491d2b;
      transition: left 0.08s linear, top 0.08s linear;
      z-index: 10;
    }

    /* reveal / final message */
    .reveal {
      display: none;
      margin-top: clamp(1.5rem, 5vh, 2.8rem);
      animation: pop 0.5s ease forwards;
    }

    @keyframes pop {
      from { opacity: 0; transform: scale(0.7); }
      to { opacity: 1; transform: scale(1); }
    }

    .couple {
      font-size: clamp(3rem, 12vw, 5.5rem);
      line-height: 1.2;
    }

    .love-text {
      font-size: clamp(1.3rem, 5vw, 2.3rem);
      font-weight: 700;
      color: #982b52;
      margin-top: 0.6rem;
      line-height: 1.4;
    }

    /* extra micro adjustments for very small widths */
    @media (max-width: 380px) {
      .btn {
        padding: 8px 16px;
        font-size: 0.9rem;
      }
      .button-swarm {
        height: 80px;
      }
    }

    /* landscape tiny height */
    @media (max-height: 550px) {
      .valentine-card {
        padding: 1rem 1rem;
      }
      h1 {
        margin-bottom: 0.8rem;
      }
      .button-swarm {
        height: 75px;
      }
    }

    /* large screens > 1400px */
    @media (min-width: 1400px) {
      .valentine-card {
        width: 750px;
        padding: 4rem 2.5rem;
      }
      h1 {
        font-size: 3rem;
      }
      .btn {
        font-size: 2rem;
        padding: 20px 60px;
      }
      .couple {
        font-size: 6rem;
      }
    }
  </style>
</head>
<body>

<div class="valentine-card">

  <!-- FIRST QUESTION (valentine) -->
  <div id="card1">
    <h1>Will you be my Valentine? üíå</h1>
    <div class="button-swarm" id="swarm1">
      <button class="btn" id="noBtn">No üòò</button>
      <button class="btn" id="yesBtn">Yes üíñ</button>
    </div>
  </div>

  <!-- SECOND QUESTION (marry me) -->
  <div id="card2" style="display:none;">
    <h1>Will you marry me? üíç</h1>
    <div class="button-swarm" id="swarm2">
      <button class="btn" id="noBtn2">No üòÖ</button>
      <button class="btn" id="yesBtn2">Yes üíç</button>
    </div>
  </div>

  <!-- FINAL MESSAGE (both yes) -->
  <div class="reveal" id="finalMessage">
    <div class="couple">üíë‚ú®üíñ</div>
    <div class="love-text">
      Forever starts today üíçüíû <br>
      You & Me ‚Äì Always Together ‚ù§Ô∏è
    </div>
  </div>

</div>

<script>
(function() {
  // ----- state -----
  let card1Done = false;   // not strictly needed but kept for clarity
  let card2Done = false;

  // ----- elements -----
  const card1 = document.getElementById('card1');
  const card2 = document.getElementById('card2');
  const finalMsg = document.getElementById('finalMessage');

  const noBtn1 = document.getElementById('noBtn');
  const yesBtn1 = document.getElementById('yesBtn');
  const swarm1 = document.getElementById('swarm1');

  const noBtn2 = document.getElementById('noBtn2');
  const yesBtn2 = document.getElementById('yesBtn2');
  const swarm2 = document.getElementById('swarm2');

  // ---------- FLEE LOGIC (same for both NO buttons) ----------
  function makeEscape(noBtn, swarm, getAnsweredFlag) {
    // getAnsweredFlag is a function that returns true if card is already answered
    function moveAway(cursorX, cursorY) {
      if (getAnsweredFlag && getAnsweredFlag()) return;

      const btnRect = noBtn.getBoundingClientRect();
      const swarmRect = swarm.getBoundingClientRect();

      // Calculate direction away from cursor
      let dx = (btnRect.left + btnRect.width / 2) - cursorX;
      let dy = (btnRect.top + btnRect.height / 2) - cursorY;
      const length = Math.hypot(dx, dy);
      if (length < 2) return; // too close to zero

      dx /= length;
      dy /= length;

      const MOVE_DIST = 45; // >20px

      let newLeft = btnRect.left + dx * MOVE_DIST;
      let newTop = btnRect.top + dy * MOVE_DIST;

      // Keep inside swarm
      const minLeft = swarmRect.left + 5;
      const maxLeft = swarmRect.right - btnRect.width - 5;
      const minTop = swarmRect.top + 5;
      const maxTop = swarmRect.bottom - btnRect.height - 5;

      newLeft = Math.max(minLeft, Math.min(maxLeft, newLeft));
      newTop = Math.max(minTop, Math.min(maxTop, newTop));

      noBtn.style.left = (newLeft - swarmRect.left) + 'px';
      noBtn.style.top = (newTop - swarmRect.top) + 'px';
      // remove any transform (like translateY) because we use absolute left/top
      noBtn.style.transform = 'none';
    }

    // proximity mousemove
    const mouseHandler = function(e) {
      if (getAnsweredFlag && getAnsweredFlag()) return;
      const rect = noBtn.getBoundingClientRect();
      const dist = Math.hypot(
        e.clientX - (rect.left + rect.width / 2),
        e.clientY - (rect.top + rect.height / 2)
      );
      if (dist < 130) { // flee zone
        moveAway(e.clientX, e.clientY);
      }
    };

    document.addEventListener('mousemove', mouseHandler);

    // block direct clicks / touches
    noBtn.addEventListener('mousedown', function(e) {
      e.preventDefault();
      if (getAnsweredFlag && getAnsweredFlag()) return;
      moveAway(e.clientX, e.clientY);
    });

    noBtn.addEventListener('touchstart', function(e) {
      e.preventDefault();
      if (getAnsweredFlag && getAnsweredFlag()) return;
      const touch = e.touches[0];
      if (touch) moveAway(touch.clientX, touch.clientY);
    });

    noBtn.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
    });

    // return cleanup if needed (not used here)
  }

  // Flags to know if card1/card2 are already answered (buttons hidden)
  let card1Answered = false;
  let card2Answered = false;

  // Activate escape for button1
  makeEscape(noBtn1, swarm1, () => card1Answered);
  // Activate escape for button2
  makeEscape(noBtn2, swarm2, () => card2Answered);

  // ----- FIRST YES -----
  yesBtn1.addEventListener('click', function() {
    if (card1Answered) return;
    card1Answered = true; // prevent further fleeing

    // hide card1 show card2
    card1.style.display = 'none';
    card2.style.display = 'block';

    // Reset NO button2 styles so it goes back to default left/top (avoid style leakage)
    noBtn2.style.left = '';
    noBtn2.style.top = '';
    noBtn2.style.transform = ''; 
    // ensure YES button2 visible (it is by default)
    yesBtn2.style.display = ''; 
    noBtn2.style.display = ''; 
    card2Answered = false; // second card active now
  });

  // ----- SECOND YES -----
  yesBtn2.addEventListener('click', function() {
    if (card2Answered) return;
    card2Answered = true;

    card2.style.display = 'none';
    finalMsg.style.display = 'block';
  });

  // ----- floating symbols (fully responsive) -----
  const symbols = ["üíñ","üíï","üíò","üå∏","üåπ","üíû","ü•∞","üíç","üíí","üë∞‚Äç‚ôÄÔ∏è","ü§µ‚Äç‚ôÇÔ∏è"];

  setInterval(function() {
    const el = document.createElement('div');
    el.className = 'fall';
    el.innerHTML = symbols[Math.floor(Math.random() * symbols.length)];
    el.style.left = Math.random() * 100 + '%';      // vw not needed, % works
    el.style.animationDuration = (Math.random() * 4 + 4) + 's';
    // font-size already controlled by .fall clamp, but we can add extra random tweak
    // but keep inside clamp -> just set base, fine
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 8000);
  }, 280);

})();
</script>

</body>
</html>
